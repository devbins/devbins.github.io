<!DOCTYPE html>
<html lang="zn-Hans">
  <head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no, maximum-scale=1" />
  <meta name="author" content="dev.bins">
  <meta name="description" content="AOSP ä»‹ç» AOSP æ˜¯ Android å¼€æ”¾æºç é¡¹ç›®ï¼Œé€šä¿—ç‚¹å°±æ˜¯æ•´ä¸ª Android çš„æºç ã€‚æœ‰äº† AOSP æˆ‘ä»¬å°±å¯ä»¥åœ¨æºç çš„å±‚é¢å»äº†è§£æ•´ä¸ª Android ç³»ç»Ÿã€‚ç”šè‡³å¯ä»¥è‡ªå·±åŸºäº AOSP å»å®šåˆ¶è‡ªå·±ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯ä¼—å¤š ROM çš„ç›´æ¥æˆ–é—´æ¥èµ·æºã€‚ è™½ç„¶æˆ‘ä»¬ä¸ä¸€å®šä¼šå»åš ROM ï¼Œä½†å¯¹äºå¼€å‘æ¥è¯´ï¼Œäº†è§£ Android ç³»ç»Ÿçš„åº•å±‚åŸç†è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œè¿™ä¹Ÿæ˜¯æˆä¸ºé«˜çº§å·¥ç¨‹å¸ˆçš„å¿…ç»ä¹‹è·¯ã€‚æºç é‡Œé¢æœ‰éå¸¸å¤šçš„ä¸œè¥¿å€¼å¾—æˆ‘ä»¬å»å­¦ä¹ ï¼Œæ˜¯ä¸€åº§å®è—ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æŠŠè¿™ä¸ªå®è—ä¸‹è½½ä¸‹æ¥ã€‚ Repo å·¥å…· ç›®å‰å¸‚é¢ä¸Šæœ€æµè¡Œçš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…·æ˜¯ Git ï¼Œ">
  
  <meta property="og:title" content="ç”¨Dockerä¸‹è½½AOSPæºç " />
<meta property="og:description" content="AOSP ä»‹ç» AOSP æ˜¯ Android å¼€æ”¾æºç é¡¹ç›®ï¼Œé€šä¿—ç‚¹å°±æ˜¯æ•´ä¸ª Android çš„æºç ã€‚æœ‰äº† AOSP æˆ‘ä»¬å°±å¯ä»¥åœ¨æºç çš„å±‚é¢å»äº†è§£æ•´ä¸ª Android ç³»ç»Ÿã€‚ç”šè‡³å¯ä»¥è‡ªå·±åŸºäº AOSP å»å®šåˆ¶è‡ªå·±ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯ä¼—å¤š ROM çš„ç›´æ¥æˆ–é—´æ¥èµ·æºã€‚ è™½ç„¶æˆ‘ä»¬ä¸ä¸€å®šä¼šå»åš ROM ï¼Œä½†å¯¹äºå¼€å‘æ¥è¯´ï¼Œäº†è§£ Android ç³»ç»Ÿçš„åº•å±‚åŸç†è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œè¿™ä¹Ÿæ˜¯æˆä¸ºé«˜çº§å·¥ç¨‹å¸ˆçš„å¿…ç»ä¹‹è·¯ã€‚æºç é‡Œé¢æœ‰éå¸¸å¤šçš„ä¸œè¥¿å€¼å¾—æˆ‘ä»¬å»å­¦ä¹ ï¼Œæ˜¯ä¸€åº§å®è—ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æŠŠè¿™ä¸ªå®è—ä¸‹è½½ä¸‹æ¥ã€‚ Repo å·¥å…· ç›®å‰å¸‚é¢ä¸Šæœ€æµè¡Œçš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…·æ˜¯ Git ï¼Œ" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://devbins.github.io/post/aosp/" />
<meta property="article:published_time" content="2019-10-23T00:00:00+08:00" />
<meta property="article:modified_time" content="2019-10-23T00:00:00+08:00" />


  <title>
  
       ç”¨Dockerä¸‹è½½AOSPæºç  | dev.bins 
  
  </title>

  <link rel="canonical" href="https://devbins.github.io/post/aosp/">

  
  

  
  <link href="https://devbins.github.io/css/vendors-extensions/fontawesome/all.min.css" rel="stylesheet">

  
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700|Ubuntu+Mono:400,400i,700,700i|Raleway:300,400,500,600">
  <link href="https://devbins.github.io/css/font.css" rel="stylesheet"> 
    
  
  <link href="https://devbins.github.io/css/vendors/bootstrap4/bootstrap.min.css" rel="stylesheet">
  <link href="https://devbins.github.io/css/vendors-extensions/mdb/mdb.min.css" rel="stylesheet"> 
  <link href="https://devbins.github.io/css/vendors/mdb/style.min.css" rel="stylesheet"> 
  <link href="https://devbins.github.io/css/main.css" rel="stylesheet">


  
  <link rel="shortcut icon"
  
      href="https://devbins.github.io/images/fav.jpg"
  
  >


  
  

  <style type="text/css">
      @media (min-width: 800px) and (max-width: 850px) {
              .navbar:not(.top-nav-collapse) {
                  background: #1C2331!important;
              }
          }
  </style>


  
    
    <link rel="stylesheet" href="https://devbins.github.io/js/vendors/katex/katex.min.css">
  
  

  
    
    <link rel="stylesheet" href="https://devbins.github.io/css/vendors/highlight/androidstudio.css">
  

</head>

  <body class="bg-light" data-spy="scroll" data-target="#page-scrollspy" data-offset="90">
  
    

    
	  <canvas class="fireworks" style="position: fixed; left: 0px; top: 0px; z-index: 1; pointer-events: none; width: 1280px; height: 192px;" width="2560" height="384"><script type="text/javascript" src="https://devbins.github.io/js/vendors/anime.min.js"></script><script type="text/javascript" src="https://devbins.github.io/js/vendors/fireworks.js"></script></canvas>
      

    
      


<nav class="navbar fixed-top navbar-expand-lg navbar-dark scrolling-navbar">
    <div class="container">

      
      <a class="navbar-brand" href="https://devbins.github.io">
          
        <img class="avatar" src="https://devbins.github.io/images/fav.jpg" style="width: 40px!important;height: auto;"  class="d-inline-block align-top" alt="" >
        
        <strong> dev.bins</strong>
      </a>

      
      <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent"
        aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
      </button>

      
      <div class="collapse navbar-collapse" id="navbarSupportedContent">

        
        <ul class="navbar-nav mr-auto ">
          <li class="nav-item ">
            <a class="nav-link" href="https://devbins.github.io">Home</a>
          </li>
             
            <li class="nav-item ">
              <a class="nav-link" href="https://devbins.github.io/post/" >å½’æ¡£  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://devbins.github.io/categories/" >åˆ†ç±»  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://devbins.github.io/tags/" >æ ‡ç­¾  </a>
            </li>
          
             
            <li class="nav-item ">
              <a class="nav-link" href="https://devbins.github.io/about/" >å…³äº  </a>
            </li>
          
          
        </ul>

      </div>

    </div>
  </nav>
  

      
 






<div id="site-header" class="carousel slide carousel-fade" data-ride="carousel" style="height: 18rem;" >  

  
  
  

  
  <div class="carousel-inner" role="listbox">
    
      

        
        <div class="carousel-item active">
          <div class="view" style="background-image: url('https://devbins.github.io/images/slides/brett.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

              
              
              

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://devbins.github.io/images/slides//bryan.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    
      

        
        <div class="carousel-item">
          <div class="view" style="background-image: url('https://devbins.github.io/images/slides//paul.jpg'); background-repeat: no-repeat; background-size: cover;">

            
            <div class="mask rgba-black-light d-flex justify-content-center align-items-center">

            

            </div>
            

          </div>
        </div>
        
      
    

  
  </div>
  

  
  <div class="carousel-content text-center white-text wow fadeIn">
    <div class="row mx-0 headfont mt-3 pt-4">
      
      <div class="col-12 col-sm-5 align-middle">
        <a href="https://devbins.github.io">
          
            <img class="pull-right avatar avatar-md" src="https://devbins.github.io/images/avatar.jpg" alt="" >
          
        </a>
      </div>
      
      <div class="col-12 col-sm-7 text-left pl-2">
        <a href="https://devbins.github.io">
          <h1 class="mb-2 h1" style="font-weight: 300;" >
            <strong>dev.bins</strong>
          </h1>
        </a>
        

             
        <div class="mt-2" style="font-size: 1rem; color: white;">
            
            

            

            

            

            
    
            
    
        
            
                <a href="mailto:binshengh@gmail.com"><i class="far fa-envelope-open pr-1" aria-hidden="true"></i></a>
            
    
            

            
        </div>
      </div>
    </div>
  </div>
  

  
  
  

</div>

    

    
  
  <main class="post-main-wrapper">
    
    
    <div class="row">

      

      
      <div class="col-md-10">
      

        
        <div class="z-depth-1  post-wrapper white-bg single-post">

          <div class="post-header text-center" >
  <ul class="post-meta li-x">
    
      
        <li><a href="https://devbins.github.io/categories/android"><i class="fas fa-folder-open pr-1" aria-hidden="true"></i> Android </a></li>
      
    
    
  </ul>

  <div class="px-4 post-heading">ç”¨Dockerä¸‹è½½AOSPæºç </div>

  <ul class="post-meta li-x mt-1">
    
      <li>Oct 23, 2019</li>
    

    
      <li class="middot"></li>
      <li>3 minutes read</li>
    
  </ul>
  
    <div class="view">
      <img src="https://devbins.github.io/images/android.jpg" />
    </div>
  

</div>



          <div class="post-content markdown">
            <h2 id="aosp-ä»‹ç»">AOSP ä»‹ç»</h2>
<p><code>AOSP</code> æ˜¯ Android å¼€æ”¾æºç é¡¹ç›®ï¼Œé€šä¿—ç‚¹å°±æ˜¯æ•´ä¸ª <code>Android</code> çš„æºç ã€‚æœ‰äº† <code>AOSP</code> æˆ‘ä»¬å°±å¯ä»¥åœ¨æºç çš„å±‚é¢å»äº†è§£æ•´ä¸ª <code>Android</code> ç³»ç»Ÿã€‚ç”šè‡³å¯ä»¥è‡ªå·±åŸºäº <code>AOSP</code> å»å®šåˆ¶è‡ªå·±ç³»ç»Ÿï¼Œè¿™ä¹Ÿæ˜¯ä¼—å¤š <code>ROM</code> çš„ç›´æ¥æˆ–é—´æ¥èµ·æºã€‚</p>
<p>è™½ç„¶æˆ‘ä»¬ä¸ä¸€å®šä¼šå»åš <code>ROM</code> ï¼Œä½†å¯¹äºå¼€å‘æ¥è¯´ï¼Œäº†è§£ <code>Android</code> ç³»ç»Ÿçš„åº•å±‚åŸç†è¿˜æ˜¯éå¸¸æœ‰å¿…è¦çš„ï¼Œè¿™ä¹Ÿæ˜¯æˆä¸ºé«˜çº§å·¥ç¨‹å¸ˆçš„å¿…ç»ä¹‹è·¯ã€‚æºç é‡Œé¢æœ‰éå¸¸å¤šçš„ä¸œè¥¿å€¼å¾—æˆ‘ä»¬å»å­¦ä¹ ï¼Œæ˜¯ä¸€åº§å®è—ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±è¦æŠŠè¿™ä¸ªå®è—ä¸‹è½½ä¸‹æ¥ã€‚</p>
<h2 id="repo-å·¥å…·">Repo å·¥å…·</h2>
<p>ç›®å‰å¸‚é¢ä¸Šæœ€æµè¡Œçš„ç‰ˆæœ¬æ§åˆ¶ç®¡ç†å·¥å…·æ˜¯ <code>Git</code> ï¼Œ <code>AOSP</code> ä¹Ÿæ˜¯ç”¨ <code>Git</code> æ¥ç®¡ç†çš„ï¼Œä¸è¿‡ <code>AOSP</code> ä¸­æœ‰å‡ ç™¾ä¸ª <code>Git</code> ä»“åº“ç®¡ç†èµ·æ¥éå¸¸ä¸æ–¹ä¾¿ï¼Œå…‰ä¸‹è½½å°±è¦å‡ ç™¾æ¬¡ï¼Œæƒ³æƒ³éƒ½å¯æ€•ã€‚</p>
<p>ä¸ºäº†ç®¡ç† <code>AOSP</code> è¿™ä¹ˆåºå¤§çš„ä»£ç ï¼Œè°·æ­Œå¼€å‘äº† <code>Repo</code> çš„å·¥å…·ä¸“é—¨ç”¨æ¥ç®¡ç† <code>AOSP</code> ä»£ç ã€‚ <code>Ropo</code> æœ¬èº«æ˜¯ç”¨ <code>Python</code> å†™çš„ï¼Œæ˜¯å¯¹ <code>Git</code> çš„ä¸€æ¬¡å°è£…ï¼Œæ–¹ä¾¿ä½¿ç”¨ï¼Œæˆ‘ä»¬å°±ä¸è¦æ¯ä¸ªä»“åº“éƒ½å»æ“ä½œä¸€æ¬¡ã€‚</p>
<p>è¦æƒ³ä½¿ç”¨ <code>Repo</code> éœ€è¦å…ˆåœ¨ <code>Docker</code> ä¸­å®‰è£…ï¼Œç”±äºä¼—æ‰€å‘¨çŸ¥çš„åŸå› ï¼Œæˆ‘ä»¬ä½¿ç”¨å›½å†…æ¸…åå¤§å­¦çš„é•œåƒæ¥åŠ é€Ÿä¸‹è½½ï¼Œæˆ–è€…å¯ä»¥ä½¿ç”¨<a href="https://lug.ustc.edu.cn/wiki/mirrors/help/aosp">ä¸­å›½ç§‘å­¦æŠ€æœ¯å¤§å­¦AOSP</a> ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">mkdir ~/bin
curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo &gt; ~/bin/repo
chmod a+x ~/bin/repo
</code></pre></div><h2 id="åˆ›å»ºä¸€ä¸ªæŒ‚è½½é•œåƒç£ç›˜">åˆ›å»ºä¸€ä¸ªæŒ‚è½½é•œåƒç£ç›˜</h2>
<p>Mac ä¸Šçš„æ–‡ä»¶åé»˜è®¤æ˜¯ä¸åŒºåˆ†å¤§å°å†™çš„ï¼Œæˆ‘ä»¬é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªæ”¯æŒå¤§å°å†™çš„é•œåƒæ–‡ä»¶ï¼Œç”¨æ¥å­˜æ”¾ä¸‹è½½çš„ <code>AOSP</code> ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯å½“å®¹å™¨è¢«åˆ é™¤çš„æ—¶å€™ï¼Œä¸‹è½½çš„å†…å®¹ä¸ä¼šè·Ÿç€ä¸€èµ·è¢«åˆ é™¤ã€‚</p>
<p>æ‰“å¼€ <code>Disk Utility</code> ï¼ŒæŒ‰ä¸‹ <code>âŒ˜ + N</code> åˆ›å»ºä¸€ä¸ªï¼Œè®°å¾—è¦é€‰æ‹©å¤§å°å†™æ•æ„Ÿçš„æ ¼å¼ã€‚å¦‚æœä½ éœ€è¦ç¼–è¯‘ï¼Œæœ€å¥½è¦æœ‰ 300Gï¼Œåœ¨ <code>Android 10</code> ä¸Šã€‚ä¸éœ€è¦ç¼–è¯‘ç»™ 150G å°±å¤Ÿäº†ã€‚</p>
<h2 id="æ„å»ºå®¹å™¨å¹¶å¯åŠ¨">æ„å»ºå®¹å™¨å¹¶å¯åŠ¨</h2>
<h3 id="dockerfile">Dockerfile</h3>
<div class="highlight"><pre class="chroma"><code class="language-dockerfile" data-lang="dockerfile"><span class="k">FROM</span><span class="s"> ubuntu</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">PATH</span><span class="o">=</span><span class="s2">&#34;/root/bin:</span><span class="si">${</span><span class="nv">PATH</span><span class="si">}</span><span class="s2">&#34;</span><span class="err">
</span><span class="err"></span><span class="k">ENV</span> <span class="nv">REPO_URL</span><span class="o">=</span><span class="s1">&#39;https://mirrors.tuna.tsinghua.edu.cn/git/git-repo/&#39;</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">RUN</span> apt update <span class="o">&amp;&amp;</span> apt install -y git curl python openjdk-8-jdk git-core gnupg flex bison gperf build-essential zip zlib1g-dev gcc-multilib g++-multilib libc6-dev-i386 lib32ncurses5-dev x11proto-core-dev libx11-dev lib32z-dev ccache libgl1-mesa-dev libxml2-utils xsltproc unzip <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm -rf /var/cahce/apt <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    rm -rf /var/lib/apt/lists <span class="o">&amp;&amp;</span> <span class="se">\
</span><span class="se"></span>    mkdir ~/bin <span class="o">&amp;&amp;</span> curl https://mirrors.tuna.tsinghua.edu.cn/git/git-repo &gt; ~/bin/repo <span class="o">&amp;&amp;</span> chmod a+x ~/bin/repo <span class="o">&amp;&amp;</span> mkdir ~/aosp<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">VOLUME</span><span class="s"> ~/aosp</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">WORKDIR</span><span class="s"> ~/aosp</span><span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">COPY</span> entrypoint.sh /root/entrypoint.sh<span class="err">
</span><span class="err">
</span><span class="err"></span><span class="k">ENTRYPOINT</span> <span class="p">[</span><span class="s2">&#34;/root/entrypoint.sh&#34;</span><span class="p">]</span><span class="err">
</span></code></pre></div><h3 id="entrypoint">ENTRYPOINT</h3>
<p><code>entrypoint</code> æ˜¯ä¸ª <code>shell</code> è„šæœ¬ï¼Œç”¨æ¥åœ¨å¯åŠ¨å®¹å™¨æ—¶æ‰§è¡Œå‘½ä»¤ç”¨çš„ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬åªè¦åˆå§‹åŒ– <code>repo</code> å¹¶æ‰§è¡Œ <code>sync</code> å°±ä¼šå¼€å§‹ä¸‹è½½ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh"><span class="cp">#!/bin/bash
</span><span class="cp"></span><span class="nb">cd</span> ~/aosp
<span class="nb">echo</span> <span class="s2">&#34;start sync&#34;</span>
repo init -u https://aosp.tuna.tsinghua.edu.cn/platform/manifest <span class="o">&amp;&amp;</span> repo sync

<span class="nb">exec</span> <span class="s2">&#34;</span><span class="nv">$@</span><span class="s2">&#34;</span>
</code></pre></div><h3 id="å¯åŠ¨å®¹å™¨å¹¶å¼€å§‹ä¸‹è½½">å¯åŠ¨å®¹å™¨å¹¶å¼€å§‹ä¸‹è½½</h3>
<p>å‡†å¤‡å¥½ <code>Dockerfile</code> å’Œ <code>entrypoint</code> åï¼Œæˆ‘ä»¬å¼€å§‹æ„å»ºé•œåƒ
<code>docker build -t aosp .</code>
æ‰§è¡Œæ„å»ºéœ€è¦ä¸€å®šçš„æ—¶é—´ï¼Œç­‰å¾…æ„å»ºå®Œæˆã€‚æ„å»ºå®Œæˆåï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢æŒ‡ä»¤å¯åŠ¨å®¹å™¨
<code>docker run -v /Volumes/Android10:/root/aosp --name aosp aosp sync</code>
åœ¨ä¸‹è½½çš„è¿‡ç¨‹ä¸­ï¼Œæˆ‘ç»å¸¸ä¼šç¢°åˆ°å®¹å™¨æ„å¤–é€€å‡ºã€‚å¯ä»¥é€šè¿‡ <code>docker start aosp</code> æ¥é‡å¯å®¹å™¨ã€‚</p>
<h3 id="æˆåŠŸ">æˆåŠŸ</h3>
<p>å¦‚æœä½ çœ‹åˆ°å¦‚ä¸‹æ‰€ç¤ºï¼Œè¡¨ç¤ºä¸‹è½½å®Œæˆäº†ã€‚</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">Checking out project platform/test/vts-testcase/hal-trace
Checking out project platform/test/vts-testcase/kernel
Checking out project platform/test/vts-testcase/performance
Syncing work tree:  98% <span class="o">(</span>557/568<span class="o">)</span>Checking out project platform/test/vts-testcase/security
Checking out project platform/test/vts-testcase/vndk
Checking out project toolchain/binutils
Checking out project platform/tools/apksig
Checking out project platform/tools/external/fat32lib
Checking out project platform/tools/external/gradle
Syncing work tree:  99% <span class="o">(</span>563/568<span class="o">)</span>Checking out project platform/tools/loganalysis
Checking out project platform/tools/repohooks
Checking out project platform/tools/test/connectivity
Checking out project platform/tools/tradefederation/contrib
Checking out project platform/tools/tradefederation
Syncing work tree: 100% <span class="o">(</span>568/568<span class="o">)</span>, <span class="k">done</span>.
</code></pre></div><h3 id="ç¢°åˆ°çš„é”™è¯¯">ç¢°åˆ°çš„é”™è¯¯</h3>
<h4 id="entrypoint-dot-sh-permission-denied">entrypoint.sh permission denied</h4>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">docker: Error response from daemon: OCI runtime create failed: container_linux.go:345: starting container process caused <span class="s2">&#34;exec: \&#34;/root/entrypoint.sh\&#34;: permission denied&#34;</span>: unknown.
</code></pre></div><p>è¿™ä¸ªé—®é¢˜æ˜¯åœ¨å®¿ä¸»æœºä¸Šæ²¡æœ‰ç»™æ‰§è¡Œæƒé™ï¼Œåœ¨å®¿ä¸»æœºä¸Šæ‰§è¡Œä¸‹é¢æŒ‡ä»¤
<code>chmod a+x entrypoint.sh</code></p>
<h4 id="error-rpc-failed-curl-56-gnutls-recv-error--54--error-in-the-pull-function-dot">error: RPC failed; curl 56 GnuTLS recv error (-54): Error in the pull function.</h4>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">error: RPC failed<span class="p">;</span> curl <span class="m">56</span> GnuTLS recv error <span class="o">(</span>-54<span class="o">)</span>: Error in the pull <span class="k">function</span>.
fatal: The remote end hung up unexpectedly
fatal: early EOF
fatal: index-pack failed
</code></pre></div><p>è¿™ä¸ªé”™è¯¯æ˜¯ç”±äº <code>git</code> çš„ç¼“å­˜è®¾ç½®çš„ä¸å¤Ÿå¤§</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">git config --global http.sslVerify <span class="nb">false</span>
git config --global http.postBuffer <span class="m">1073741824</span>
</code></pre></div><p>å¦‚æœè®¾ç½®çš„å¤ªå¤§äº†ä¼šåŒ…ä¸‹é¢çš„é”™è¯¯</p>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">fatal: Out of memory, malloc failed <span class="o">(</span>tried to allocate <span class="m">20000000000</span> bytes<span class="o">)</span>
</code></pre></div><h4 id="index-pack-died-of-signal-952">index-pack died of signal 952</h4>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">git config --global pack.windowMemory <span class="s2">&#34;32m&#34;</span>
</code></pre></div><h4 id="server-does-not-provide-clone-dot-bundle">Server does not provide clone.bundle</h4>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">curl: <span class="o">(</span>22<span class="o">)</span> The requested URL returned error: <span class="m">404</span>
Server does not provide clone.bundle<span class="p">;</span> ignoring.
</code></pre></div><p>å¦‚æœä½ ç”¨çš„æ¸…åçš„æºï¼Œä¼šç¢°åˆ°è¿™ä¸ªé—®é¢˜ï¼Œè¿™æ˜¯ç”±äºæ¸…åçš„æºä¸æ”¯æŒ <code>git</code> åè®®å¯¼è‡´çš„ï¼Œå¿½ç•¥å°±å¥½ï¼Œä¸å½±å“ä¸‹è½½ã€‚</p>
<h2 id="æ€»ç»“">æ€»ç»“</h2>
<p>åœ¨ <code>Docker</code> ä¸­ä¸‹è½½ <code>AOSP</code> å¯¹äºæ²¡æœ‰ <code>Linux</code> çš„å°ä¼™ä¼´æ¥è¯´æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ï¼Œä¸éœ€è¦å»å®‰è£…è™šæ‹Ÿæœºï¼Œåªéœ€è¦å¯åŠ¨ä¸€ä¸ªå®¹å™¨å°±å¯ä»¥äº†ã€‚</p>
<p>ä½†æ˜¯ç°å®å¾€å¾€æ²¡é‚£ä¹ˆå®¹æ˜“ï¼Œåœ¨ä½¿ç”¨çš„è¿‡ç¨‹ä¸­ä¼šå‘ç°ï¼Œå®¹å™¨è«åå…¶å¦™å°±é€€å‡ºäº†ï¼Œéœ€è¦ä¸æ–­çš„é‡å¯å®¹å™¨æ¥ç¡®ä¿ä¸‹è½½å®Œæˆã€‚</p>
<p>å¦‚æœä½ éœ€è¦ç¼–è¯‘çš„è¯è¿˜æ˜¯å»ºè®®ç”¨è™šæ‹Ÿæœºæ¥è¿›è¡Œï¼Œç”¨å®¹å™¨å°±éå¸¸ä¸æ–¹ä¾¿äº†ã€‚</p>
<p>æœ€åè¿˜æ˜¯å»ºè®®ä½¿ç”¨è™šæ‹Ÿæœºæ¥ä¸‹è½½ <code>AOSP</code> ï¼Œè¿™æ ·ä¸ç”¨ä¸€ç›´å»è§‚å¯Ÿå®¹å™¨çš„çŠ¶æ€ï¼Œè™šæ‹Ÿæœºä¸‹è½½çš„ä½“éªŒä¼šæ¯”ä½¿ç”¨ <code>Docker</code> å¥½å¾ˆå¤šï¼Œä¹Ÿæ›´èŠ‚çœæ—¶é—´ã€‚</p>
<h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ul>
<li><a href="https://lug.ustc.edu.cn/wiki/mirrors/help/aosp">AOSP(Android) é•œåƒä½¿ç”¨å¸®åŠ© {LUG@USTC}</a></li>
<li><a href="http://blog.michaelx.tech/2017-03/Ubuntu-14-04%25E7%25BC%2596%25E8%25AF%2591AOSP-for-Nexus-Pixel/">Ubuntu 14.04ç¼–è¯‘AOSP for Nexus/Pixel | MichaelX&rsquo;s Blog | MichaelXçš„å¼€å‘åšå®¢</a></li>
<li><a href="https://github.com/Trumeet/AOSP-Build-Environment-Docker">GitHub - Trumeet/AOSP-Build-Environment-Docker: A docker image to provide a systemless AOSP build environment</a></li>
<li><a href="https://github.com/openstf/docker-aosp">GitHub - openstf/docker-aosp: Docker images for checking out AOSP branches and building external code inside the source tree.</a></li>
<li><a href="https://github.com/kylemanna/docker-aosp">GitHub - kylemanna/docker-aosp: ğŸ— Minimal Android AOSP build environment with handy automation wrapper scripts</a></li>
<li><a href="https://source.android.google.cn/setup/start/build-numbers#source-code-tags-and-builds">Codenames, Tags, and Build Numbers Â |Â  Android Open Source Project</a></li>
<li><a href="https://blog.csdn.net/counsellor/article/details/86591081">repo å·¥å…·ä½¿ç”¨æ‰‹å†Œ - counsellorçš„ä¸“æ </a></li>
</ul>

          </div>

          
          <div class="row">
            <div class="col-md-8">
            
              <div class="mb-5">
                
<div class="li-x div-x post-meta">
  <li class="pr-0"><a href="https://devbins.github.io/tags/"><i class="fas fa-tags"></i></a></li>
  <div class="tags-sm">
    
      <li><a href="https://devbins.github.io/tags/android" role="button">Android </a></li>
      
    
  </div>
</div>
              </div>
            
            </div>
            
          </div>
          

          
          


          
          <div>
    <ul class="post-copyright">
        <li class="post-copyright-author">
            <strong>æœ¬æ–‡ä½œè€…ï¼š </strong>dev.bins</li>
        <li class="post-copyright-link">
            <strong>æœ¬æ–‡é“¾æ¥ï¼š</strong>
            <a href="https://devbins.github.io/post/aosp/" title="ç”¨Dockerä¸‹è½½AOSPæºç ">ç”¨Dockerä¸‹è½½AOSPæºç </a>
        </li>
        <li class="post-copyright-license">
            <strong>ç‰ˆæƒå£°æ˜ï¼š </strong>æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 4.0</a> è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼</li>
    </ul>

</div>


          
          <div class="row pt-3 np">
            <div class="col-md-6">
              
                <a href=https://devbins.github.io/post/plantuml/ class="post-meta">Previous
                  <div class="pt-2 pb-5 d-flex">
                    <i class="fas fa-angle-left text-grey font-weight-bold mr-2 active-color"></i>
                    <span>åœ¨emacsä¸­ç”¨PlantUmlç”»uml</span>
                  </div>
                </a>
              
            </div>
            
            <div class="col-md-6 text-right" >
              
                <a href=https://devbins.github.io/post/parallel/ class="post-meta">Next
                  <div class="pt-2 pb-5 flex-reverse">
                    <i class="fas fa-angle-right text-grey font-weight-bold ml-2 active-color"></i>
                    <span>Parallels tools å®‰è£…å¤±è´¥</span>
                  </div>
                </a>
              
            </div>
          </div>

          

        </div>
        

      </div>
      

      
	
	
	
	
		
		
		
	

		
		<div class="col-md-2 pl-0">

			
			<div id="page-scrollspy" class="toc-nav">
				
				<ul class="nav nav-pills ml-0">
					
					<li class="nav-item pb-3 text-center">
						<span class="font-weight-bold mb-2">- CATALOG - </span>
					</li>

					
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#aosp-%e4%bb%8b%e7%bb%8d">
												 AOSP ä»‹ç»
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#repo-%e5%b7%a5%e5%85%b7">
												 Repo å·¥å…·
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e5%88%9b%e5%bb%ba%e4%b8%80%e4%b8%aa%e6%8c%82%e8%bd%bd%e9%95%9c%e5%83%8f%e7%a3%81%e7%9b%98">
												 åˆ›å»ºä¸€ä¸ªæŒ‚è½½é•œåƒç£ç›˜
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e6%9e%84%e5%bb%ba%e5%ae%b9%e5%99%a8%e5%b9%b6%e5%90%af%e5%8a%a8">
												 æ„å»ºå®¹å™¨å¹¶å¯åŠ¨
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#dockerfile">
												 Dockerfile
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#entrypoint">
												 ENTRYPOINT
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e5%90%af%e5%8a%a8%e5%ae%b9%e5%99%a8%e5%b9%b6%e5%bc%80%e5%a7%8b%e4%b8%8b%e8%bd%bd">
												 å¯åŠ¨å®¹å™¨å¹¶å¼€å§‹ä¸‹è½½
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e6%88%90%e5%8a%9f">
												 æˆåŠŸ
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e7%a2%b0%e5%88%b0%e7%9a%84%e9%94%99%e8%af%af">
												 ç¢°åˆ°çš„é”™è¯¯
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#entrypoint-dot-sh-permission-denied">
												 entrypoint.sh permission denied
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#error-rpc-failed-curl-56-gnutls-recv-error--54--error-in-the-pull-function-dot">
												 error: RPC failed; curl 56 GnuTLS recv error (-54): Error in the pull function.
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#index-pack-died-of-signal-952">
												 index-pack died of signal 952
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
									<ul class="nav">
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#server-does-not-provide-clone-dot-bundle">
												 Server does not provide clone.bundle
											</a>
										</li>
						 
								
								
									</ul>
								
									</ul>
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e6%80%bb%e7%bb%93">
												 æ€»ç»“
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 
						
						
							
								
								
									<ul class="nav">
								
								

										<li class="nav-item">
						 					<a class="nav-link" href="#%e5%8f%82%e8%80%83">
												 å‚è€ƒ
											</a>
										</li>
						 
								
								
									</ul>
								
							
						
				 

				</ul>
			</div>
			

		</div>
		
	

    </div>
    

    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">
<script src="https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>
<div id="gitalk-container"></div>
<script type="text/javascript">
    const gitalk = new Gitalk({
        clientID: '1234e4dd9e0ad49470be',
        clientSecret: '9acb7351fca3dcca6d3cc50be8a1d2cf329f4163',
        repo: "devbins.github.io",
        owner: 'devbins',
        admin: ["devbins"],
        id: location.pathname, 
        distractionFreeMode:  false  
    })

    gitalk.render('gitalk-container')
</script>




  </main>
  



    

<footer class="page-footer text-center font-small mt-4 wow fadeIn">


  
  <div class="pb-2 mt-5 pt-5">
    
    

    

    

    

    

    


    
        <a href="mailto:binshengh@gmail.com"><i class="far fa-envelope-open mr-3" aria-hidden="true"></i></a>
    

    

    

  </div>
  

  
  <div class="copyright py-4">
    
      <span>  2016 - 2020 &copy; | Theme <a href='https://github.com/devbins/AllinOne.git' target="_blank">AllinOne</a> by <a href='https://github.com/devbins' target="_blank">devbins</a>  </span>
  </div>
  

</footer>


    






<script type="text/javascript" src="https://devbins.github.io/js/vendors/jquery/jquery-3.3.1.min.js"></script>
<script type="text/javascript" src="https://devbins.github.io/js/vendors/jquery/jquery.smooth-scroll.min.js"></script>



<script type="text/javascript" src="https://devbins.github.io/js/vendors/popper.min.js"></script>
<script type="text/javascript" src="https://devbins.github.io/js/vendors/holder.min.js"></script>
<script type="text/javascript" src="https://devbins.github.io/js/vendors-extensions/bootstrap4/bootstrap.js" ></script>

<script type="text/javascript" src="https://devbins.github.io/js/vendors/mdb/mdb.min.js"></script>

<script type="text/javascript" src="https://devbins.github.io/js/main.js"></script>



  
  <script src="https://devbins.github.io/js/vendors/highlight.pack.js"> </script>
  <script>hljs.initHighlightingOnLoad();</script>




 
  <script src="https://devbins.github.io/js/vendors/katex/katex.min.js"> </script>
  <script src="https://devbins.github.io/js/vendors/katex/contrib/auto-render.min.js"></script>

  <script>
      document.addEventListener("DOMContentLoaded", function () {
          renderMathInElement(document.body);
      });
  </script>








<script type="text/javascript">
  
  new WOW().init();
</script>




  </body>
</html>
